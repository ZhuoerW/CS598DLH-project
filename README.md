# CS598DLH-project

This project is reproducing the research project of drug Repurposing for COVID-19 using "Graph Neural Network with Genetic, Mechanistic, and Epidemiological Validation".

# Data required
The dataset for this project includes the Chemical-Gene Interactions, Genes, Phenotypes, and Pathways from COVID-19 curated list in CTDbase. 
We have included all these data inside the data folder. 

> Chemical_Gene Interactions -> ./data/CTD_D000086382_ixns_20220415180917.tsv
> 
> Pathways -> ./data/CTD_D000086382_pathways_20220415180342.tsv
> 
> Phenotypes -> ./data/CTD_D000086382_diseases_20220415180531.tsv

The alldrug and nondrugbank:
> ./data/alldrugbank.csv

> ./data/nondrugbank.csv

The dataset for virus-host protein-protein interaction is provided by Gordon et al.
> ./data/41586_2020_2286_MOESM5_ESM.xlsx

The existing DRKG embedding
> ./data/DRKG/embed/DRKG_TransE_l2_entity.npy
> 
> data/DRKG/embed/entities.tsv
> 
> data/DRKG/embed/relations.tsv

For the DRKG embedding, you should first download drkg.tar.gz with 
> wget https://dgl-data.s3-us-west-2.amazonaws.com/dataset/DRKG/drkg.tar.gz.

Then move the drkg.tar.gz under the ./data/DRKG and unzip it with  
> tar -czvf drkg.tar.gz

# Reproducing Pipeline
## Data preprocessing
The data preprocessing will load all the required data, filter the data, and create the edge_index, node features, codes, and the label encoder by utilizing the pretrained DRKG embedding. The code for data preprocessing is in 
> ./preprocess.ipynb


The following file will be generated after the data preprocessing. These files will be loaded and used to generate the knowledge graph in the next step. 
> ./data/codes.pkl
> 
> ./data/edge_index.pkl
> 
> ./data/LabelEncoder.pkl
> 
> ./data/node_feature.pkl

## Drug-repurposing-pipeline 
The code for the drug-reproposing pipeline is in 
> ./graph-representation-ranking.ipynb

The pipeline first load the .pkl files generated by the data preprocessing to construct the knowledge graph. The next step is to build and train the proposed embedding model and test it's link prediction accuracy with the general embedding. Then it builds the neural network ranking model with the Bayesian pairwise ranking loss. To evaluate the performance of this ranking model, its ranking result is compared with some baseline models, such as Logistic Regression, Random Forest, SVM, and XGBoost. Finally, the pipeline generates a list of top300 drugs for Covid-19 treatment.
> ./top300_drugs.csv

You may change the embedding model used in the pipeline by changing the True/False value of the variable _DRKG_. Detailed instruction is available in the pipeline code. 

# Code Reference
https://github.com/yejinjkim/drug-repurposing-graph
